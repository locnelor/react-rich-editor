import * as Popover from "@radix-ui/react-popover";
import { keyframes, styled } from "@stitches/react";
import { mauve, violet } from '@radix-ui/colors';
import React from "react";
import { Close } from "@icon-park/react";

const slideUpAndFade = keyframes({
    '0%': { opacity: 0, transform: 'translateY(2px)' },
    '100%': { opacity: 1, transform: 'translateY(0)' },
});

const slideRightAndFade = keyframes({
    '0%': { opacity: 0, transform: 'translateX(-2px)' },
    '100%': { opacity: 1, transform: 'translateX(0)' },
});

const slideDownAndFade = keyframes({
    '0%': { opacity: 0, transform: 'translateY(-2px)' },
    '100%': { opacity: 1, transform: 'translateY(0)' },
});

const slideLeftAndFade = keyframes({
    '0%': { opacity: 0, transform: 'translateX(2px)' },
    '100%': { opacity: 1, transform: 'translateX(0)' },
});

export const UiPopoverContent = styled(Popover.Content, {
    borderRadius: 4,
    padding: 20,
    width: 260,
    backgroundColor: 'white',
    boxShadow: 'hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px',
    animationDuration: '400ms',
    animationTimingFunction: 'cubic-bezier(0.16, 1, 0.3, 1)',
    willChange: 'transform, opacity',
    '&[data-state="open"]': {
        '&[data-side="top"]': { animationName: slideDownAndFade },
        '&[data-side="right"]': { animationName: slideLeftAndFade },
        '&[data-side="bottom"]': { animationName: slideUpAndFade },
        '&[data-side="left"]': { animationName: slideRightAndFade },
    },
    '&:focus': {
        boxShadow: `hsl(206 22% 7% / 35%) 0px 10px 38px -10px, hsl(206 22% 7% / 20%) 0px 10px 20px -15px, 0 0 0 2px ${violet.violet7}`,
    },
});

export const UiPopoverArrow = styled(Popover.Arrow, {
    fill: 'white',
});

export const UiPopoverClose = styled(Popover.Close, {
    all: 'unset',
    fontFamily: 'inherit',
    borderRadius: '100%',
    height: 25,
    width: 25,
    display: 'inline-flex',
    alignItems: 'center',
    justifyContent: 'center',
    color: violet.violet11,
    position: 'absolute',
    top: 5,
    right: 5,
    '&:hover': { backgroundColor: violet.violet4 },
    '&:focus': { boxShadow: `0 0 0 2px ${violet.violet7}` },
});
export const UiPopoverTrigger = Popover.PopoverTrigger
export const UiPopoverPortal = Popover.Portal
export const UiPopoverRoot = Popover.Root
export type UiPopoverProps = React.PropsWithChildren<{
    trigger: React.ReactNode
}>


const UiPopover = ({
    trigger,
    children
}: UiPopoverProps) => {

    return (
        <UiPopoverRoot>
            <UiPopoverTrigger>
                {trigger}
            </UiPopoverTrigger>
            <UiPopoverPortal>
                <UiPopoverContent sideOffset={5}>
                    {children}
                    <UiPopoverClose aria-label="Close">
                        <Close />
                    </UiPopoverClose>
                </UiPopoverContent>
            </UiPopoverPortal>
        </UiPopoverRoot>
    )
}
export default UiPopover


